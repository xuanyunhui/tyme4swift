flowchart TD
    START([Phase 开始]) --> DEV[开发]

    subgraph STAGE1["① 开发 Dev"]
        DEV
    end

    DEV --> BUILD[构建：编译与自动化测试]
    BUILD --> QA[QA 测试]
    QA --> GATE1{质量门禁：测试通过?}
    GATE1 -->|否 快速反馈| DEV
    GATE1 -->|是| PUSH[推送 feature 分支]
    PUSH --> PR[创建 PR 至 main]

    subgraph STAGE2["② 构建与测试 Build & Test"]
        BUILD
        QA
        GATE1
    end

    subgraph STAGE3["③ 提交与评审 Submit & Review"]
        PUSH
        PR
        REVIEW[并行评审]
        subgraph ARCH["架构师 架构审查"]
            D1[架构评审]
            D2[GitHub Review]
            D1 --> D2
        end
        subgraph AUDIT["Audit Manager 审计"]
            E1[全量审计]
            E2[向 team-lead 汇报]
            E1 --> E2
        end
        REVIEW --> D1
        REVIEW --> E1
    end

    PR --> REVIEW
    D2 --> GATE2{质量与合规门禁：均通过?}
    E2 --> GATE2
    GATE2 -->|否 快速反馈| DEV
    GATE2 -->|是| MERGE[合并 PR]
    MERGE --> CHECK[更新 Issue checklist]
    CHECK --> NEXT[通知进入下一 Phase]

    subgraph STAGE4["④ 发布 Release"]
        MERGE
        CHECK
        NEXT
    end

    NEXT --> END([本 Phase 结束])
